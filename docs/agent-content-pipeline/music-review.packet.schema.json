{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Music Review Content Packet",
  "type": "object",
  "required": [
    "type",
    "sourceInput",
    "spotify",
    "lyrics",
    "frontmatter",
    "bodyBrief",
    "sources",
    "confidence"
  ],
  "properties": {
    "type": { "const": "music-review" },
    "sourceInput": {
      "type": "object",
      "required": ["spotifyUrl"],
      "properties": {
        "spotifyUrl": { "type": "string", "format": "uri" },
        "lyricsProvided": { "type": ["string", "null"] },
        "notes": { "type": "string" }
      }
    },
    "spotify": {
      "type": "object",
      "required": ["track", "artist", "album", "spotifyId"],
      "properties": {
        "track": { "type": "string" },
        "artist": { "type": "string" },
        "artists": { "type": "array", "items": { "type": "string" } },
        "album": { "type": "string" },
        "releaseDate": { "type": "string" },
        "spotifyId": { "type": "string" },
        "spotifyUrl": { "type": "string", "format": "uri" },
        "albumArt": { "type": ["string", "null"], "format": "uri" },
        "duration": { "type": "integer" },
        "genres": { "type": "array", "items": { "type": "string" } },
        "preview": { "type": ["string", "null"], "format": "uri" }
      }
    },
    "lyrics": {
      "type": "object",
      "properties": {
        "status": { "type": "string", "enum": ["provided", "fetched", "missing"] },
        "text": { "type": ["string", "null"] },
        "source": { "type": ["string", "null"], "format": "uri" }
      }
    },
    "frontmatter": {
      "type": "object",
      "required": [
        "title",
        "artist",
        "artists",
        "album",
        "releaseDate",
        "spotifyUrl",
        "spotifyId",
        "albumArt",
        "duration",
        "genres",
        "pubDate",
        "tags",
        "aiGenerated"
      ],
      "properties": {
        "title": { "type": "string" },
        "artist": { "type": "string" },
        "artists": { "type": "array", "items": { "type": "string" } },
        "album": { "type": "string" },
        "releaseDate": { "type": "string" },
        "spotifyUrl": { "type": "string", "format": "uri" },
        "spotifyId": { "type": "string" },
        "albumArt": { "type": ["string", "null"], "format": "uri" },
        "duration": { "type": "integer" },
        "genres": { "type": "array", "items": { "type": "string" } },
        "preview": { "type": ["string", "null"], "format": "uri" },
        "pubDate": { "type": "string", "pattern": "^\\d{4}-\\d{2}-\\d{2}$" },
        "tags": { "type": "array", "items": { "type": "string" } },
        "aiGenerated": { "type": "boolean" }
      }
    },
    "bodyBrief": {
      "type": "object",
      "required": ["angle", "mustInclude", "mustAvoid"],
      "properties": {
        "angle": { "type": "string" },
        "mustInclude": { "type": "array", "items": { "type": "string" } },
        "mustAvoid": { "type": "array", "items": { "type": "string" } }
      }
    },
    "sources": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["url", "kind"],
        "properties": {
          "url": { "type": "string", "format": "uri" },
          "kind": { "type": "string" },
          "note": { "type": "string" }
        }
      }
    },
    "confidence": { "type": "string", "enum": ["high", "medium", "low"] },
    "flags": { "type": "array", "items": { "type": "string" } }
  }
}
